name: Build Docker
on: push
jobs:
    docker:
        runs-on: ubuntu-20.04
        steps:
            - name: Checkout
              uses: actions/checkout@v2

            - name: Determine Tag
              id: vars
              run: echo ::set-output name::sha_short::$(echo ${{ github.sha }} | cut -c1-8)

            - name: Build
              uses: docker/build-push-action@v2
              with:
                  tags: |
                      snowblossom/snowblossom:${{ github.ref }},\
                      snowblossom/snowblossom:${{ github.ref }}-${{ steps.vars.outputs.sha_short }},\
                      snowblossom/snowblossom:${{ steps.vars.outputs.sha_short }}
